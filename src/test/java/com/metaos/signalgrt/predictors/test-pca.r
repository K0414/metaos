
#
# Vols before removeing outliers.
#
vols<-array(dim=c(104,5))
vols[,1]<-c(55219 , 262256 , 202661 , 218359 , 178244 , 99610 , 92348 , 124795 , 214370 , 153854 , 204116 , 173501 , 85390 , 156835 , 108070 , 23755 , 118573 , 70117 , 55768 , 52643 , 71485 , 407645 , 442909 , 129109 , 188896 , 79590 , 422121 , 290067 , 227955 , 69257 , 41634 , 446002 , 579188 , 86237 , 1606794 , 83676 , 166393 , 84987 , 875905 , 117013 , 399084 , 116190 , 149507 , 207221 , 60857 , 155612 , 448006 , 198637 , 67695 , 65423 , 180038 , 88774 , 80273 , 86065 , 85231 , 38867 , 29330 , 116353 , 26887 , 34170 , 102518 , 72246 , 21274 , 70752 , 37912 , 49367 , 100472 , 49461 , 41735 , 45795 , 36578 , 311945 , 249039 , 70487 , 121906 , 136424 , 195136 , 166308 , 331734 , 343180 , 419616 , 104613 , 1354058 , 162678 , 141067 , 147039 , 149115 , 271162 , 543989 , 184421 , 340679 , 201939 , 293860 , 171035 , 263964 , 260198 , 428087 , 565126 , 385874 , 547890 , 384416 , 256696 , 0 , 4738359)
vols[,2]<-c(1298630 , 678084 , 488607 , 224766 , 434263 , 356933 , 576571 , 219236 , 252805 , 414776 , 166828 , 174665 , 146281 , 110944 , 145234 , 179739 , 253111 , 175685 , 64925 , 216682 , 494507 , 100205 , 67371 , 101019 , 158026 , 316281 , 334067 , 954850 , 115547 , 163051 , 130303 , 107600 , 1407996 , 90357 , 110452 , 451866 , 238004 , 3096215 , 2672803 , 190170 , 111282 , 107135 , 453389 , 60821 , 98292 , 1310864 , 1132267 , 241907 , 89915 , 175676 , 61621 , 521553 , 212388 , 288651 , 193578 , 272161 , 256777 , 236382 , 802159 , 230248 , 387068 , 160647 , 106999 , 391933 , 465080 , 374577 , 340378 , 330708 , 416320 , 200347 , 251986 , 336664 , 311970 , 600559 , 508011 , 922379 , 311581 , 352459 , 508727 , 159316 , 1355635 , 246541 , 389672 , 805957 , 370754 , 382556 , 316971 , 564228 , 437166 , 277733 , 1284505 , 1763095 , 169661 , 280682 , 969102 , 540315 , 451895 , 308036 , 715130 , 642966 , 981563 , 900778 , 0 , 7155528)
vols[,3]<-c(679280 , 229518 , 346536 , 347215 , 316025 , 313890 , 235844 , 199995 , 1920617 , 129356 , 172084 , 207860 , 317578 , 10369008 , 480990 , 1403537 , 1021730 , 156125 , 94833 , 366987 , 145687 , 322957 , 328120 , 66657 , 176001 , 271003 , 133121 , 558624 , 264638 , 638663 , 165080 , 129439 , 5126344 , 5438632 , 248806 , 250616 , 112716 , 54523 , 198097 , 67772 , 1414565 , 244509 , 246205 , 151540 , 98584 , 51217 , 94193 , 111763 , 104726 , 45880 , 64242 , 78893 , 60706 , 48117 , 133085 , 101941 , 5103803 , 5084823 , 168230 , 75537 , 815036 , 73409 , 422412 , 437127 , 115802 , 326536 , 54707 , 81759 , 94420 , 208637 , 50361 , 1458556 , 84257 , 129114 , 54632 , 105873 , 57165 , 77578 , 233302 , 195560 , 134194 , 180928 , 140433 , 123154 , 221422 , 339866 , 1343886 , 114699 , 170052 , 150679 , 181731 , 160943 , 192590 , 125556 , 132656 , 154740 , 320932 , 140929 , 117889 , 381656 , 393635 , 306177 , 0 , 21629250)
vols[,4]<-c(526909 , 167180 , 199570 , 149154 , 142141 , 320881 , 223750 , 102275 , 258400 , 202197 , 120202 , 93404 , 178631 , 106401 , 346186 , 231729 , 163656 , 1622531 , 125689 , 2656587 , 5336032 , 2385985 , 335692 , 86118 , 130551 , 99047 , 81695 , 98846 , 238413 , 4831684 , 293262 , 124652 , 106642 , 112048 , 14284646 , 111209 , 2204635 , 128940 , 83395 , 134816 , 116320 , 65412 , 165020 , 126511 , 92217 , 111751 , 47320 , 82219 , 19044177 , 70827 , 21676 , 211214 , 103108 , 22771 , 61629 , 4816563 , 63806 , 33989 , 130104 , 146897 , 15046441 , 44977 , 40889 , 54584 , 54591 , 76634 , 238536 , 68583 , 110591 , 75012 , 503760 , 209479 , 217929 , 86397 , 102284 , 81878 , 252785 , 135884 , 129149 , 112760 , 266851 , 110863 , 67866 , 55205 , 150165 , 699438 , 184450 , 270270 , 4270036 , 345303 , 895116 , 217142 , 145398 , 301231 , 10260595 , 136317 , 442910 , 371357 , 189023 , 538928 , 438973 , 926728 , 9137 , 8879481)
vols[,5]<-c(1318228 , 1391326 , 574558 , 441739 , 719144 , 522626 , 404351 , 383602 , 490710 , 284952 , 2984474 , 216339 , 10220195 , 247067 , 166223 , 224310 , 10181837 , 126161 , 9764418 , 692337 , 25907353 , 1518741 , 1179929 , 120730 , 10173292 , 290045 , 19824327 , 402527 , 277859 , 3116841 , 7164061 , 332021 , 10560006 , 2334129 , 121753 , 200177 , 246402 , 10106648 , 1137272 , 2084673 , 461849 , 125108 , 465907 , 156972 , 139083 , 127389 , 237263 , 311691 , 156536 , 155322 , 133368 , 329715 , 256088 , 116835 , 5192615 , 823762 , 183836 , 1110239 , 2414836 , 385072 , 599637 , 387285 , 291580 , 2796924 , 12977051 , 338582 , 884415 , 525622 , 322587 , 223348 , 668858 , 143039 , 627590 , 239797 , 232788 , 256503 , 209425 , 375474 , 558106 , 290991 , 1176648 , 286550 , 149539 , 297435 , 602136 , 152733 , 212363 , 178992 , 179644 , 295428 , 933636 , 349405 , 660749 , 226061 , 868852 , 318539 , 469303 , 538061 , 273643 , 444084 , 347730 , 825808 , 12011 , 7792372)

# Volume values AFTER removing outliers.
vols[,1]<-c(55219.0,262256.0,202661.0,218359.0,178244.0,99610.0,92348.0,124795.0,214370.0,153854.0,204116.0,173501.0,85390.0,156835.0,108070.0,23755.0,118573.0,70117.0,55768.0,52643.0,71485.0,407645.0,442909.0,129109.0,188896.0,79590.0,422121.0,290067.0,227955.0,69257.0,41634.0,446002.0,579188.0,86237.0,86237.0,83676.0,166393.0,84987.0,875905.0,117013.0,399084.0,116190.0,149507.0,207221.0,60857.0,155612.0,448006.0,198637.0,67695.0,65423.0,180038.0,88774.0,80273.0,86065.0,85231.0,38867.0,29330.0,116353.0,26887.0,34170.0,102518.0,72246.0,21274.0,70752.0,37912.0,49367.0,100472.0,49461.0,41735.0,45795.0,36578.0,311945.0,249039.0,70487.0,121906.0,136424.0,195136.0,166308.0,331734.0,343180.0,419616.0,104613.0,104613.0,162678.0,141067.0,147039.0,149115.0,271162.0,543989.0,184421.0,340679.0,201939.0,293860.0,171035.0,263964.0,260198.0,428087.0,565126.0,385874.0,547890.0,384416.0,256696.0,0.0,4738359.0)
vols[,2]<-c(1298630.0,678084.0,488607.0,224766.0,434263.0,356933.0,576571.0,219236.0,252805.0,414776.0,166828.0,174665.0,146281.0,110944.0,145234.0,179739.0,253111.0,175685.0,64925.0,216682.0,494507.0,100205.0,67371.0,101019.0,158026.0,316281.0,334067.0,954850.0,115547.0,163051.0,130303.0,107600.0,1407996.0,90357.0,110452.0,451866.0,238004.0,238004.0,238004.0,190170.0,111282.0,107135.0,453389.0,60821.0,98292.0,1310864.0,1132267.0,241907.0,89915.0,175676.0,61621.0,521553.0,212388.0,288651.0,193578.0,272161.0,256777.0,236382.0,802159.0,230248.0,387068.0,160647.0,106999.0,391933.0,465080.0,374577.0,340378.0,330708.0,416320.0,200347.0,251986.0,336664.0,311970.0,600559.0,508011.0,922379.0,311581.0,352459.0,508727.0,159316.0,1355635.0,246541.0,389672.0,805957.0,370754.0,382556.0,316971.0,564228.0,437166.0,277733.0,1284505.0,1284505.0,169661.0,280682.0,969102.0,540315.0,451895.0,308036.0,715130.0,642966.0,981563.0,900778.0,0.0,7155528.0)
vols[,3]<-c(679280.0,229518.0,346536.0,347215.0,316025.0,313890.0,235844.0,199995.0,1920617.0,129356.0,172084.0,207860.0,317578.0,317578.0,480990.0,1403537.0,1021730.0,156125.0,94833.0,366987.0,145687.0,322957.0,328120.0,66657.0,176001.0,271003.0,133121.0,558624.0,264638.0,638663.0,165080.0,129439.0,129439.0,129439.0,248806.0,250616.0,112716.0,54523.0,198097.0,67772.0,1414565.0,244509.0,246205.0,151540.0,98584.0,51217.0,94193.0,111763.0,104726.0,45880.0,64242.0,78893.0,60706.0,48117.0,133085.0,101941.0,101941.0,101941.0,168230.0,75537.0,815036.0,73409.0,422412.0,437127.0,115802.0,326536.0,54707.0,81759.0,94420.0,208637.0,50361.0,1458556.0,84257.0,129114.0,54632.0,105873.0,57165.0,77578.0,233302.0,195560.0,134194.0,180928.0,140433.0,123154.0,221422.0,339866.0,1343886.0,114699.0,170052.0,150679.0,181731.0,160943.0,192590.0,125556.0,132656.0,154740.0,320932.0,140929.0,117889.0,381656.0,393635.0,306177.0,0.0,2.162925E7)
vols[,4]<-c(526909.0,167180.0,199570.0,149154.0,142141.0,320881.0,223750.0,102275.0,258400.0,202197.0,120202.0,93404.0,178631.0,106401.0,346186.0,231729.0,163656.0,1622531.0,125689.0,125689.0,125689.0,125689.0,335692.0,86118.0,130551.0,99047.0,81695.0,98846.0,238413.0,238413.0,293262.0,124652.0,106642.0,112048.0,112048.0,111209.0,111209.0,128940.0,83395.0,134816.0,116320.0,65412.0,165020.0,126511.0,92217.0,111751.0,47320.0,82219.0,82219.0,70827.0,21676.0,211214.0,103108.0,22771.0,61629.0,61629.0,63806.0,33989.0,130104.0,146897.0,146897.0,44977.0,40889.0,54584.0,54591.0,76634.0,238536.0,68583.0,110591.0,75012.0,503760.0,209479.0,217929.0,86397.0,102284.0,81878.0,252785.0,135884.0,129149.0,112760.0,266851.0,110863.0,67866.0,55205.0,150165.0,699438.0,184450.0,270270.0,270270.0,345303.0,895116.0,217142.0,145398.0,301231.0,301231.0,136317.0,442910.0,371357.0,189023.0,538928.0,438973.0,926728.0,9137.0,8879481.0)
vols[,5]<-c(1318228.0,1391326.0,574558.0,441739.0,719144.0,522626.0,404351.0,383602.0,490710.0,284952.0,284952.0,216339.0,216339.0,247067.0,166223.0,224310.0,224310.0,126161.0,126161.0,692337.0,692337.0,1518741.0,1179929.0,120730.0,120730.0,290045.0,290045.0,402527.0,277859.0,277859.0,277859.0,332021.0,332021.0,332021.0,121753.0,200177.0,246402.0,246402.0,1137272.0,1137272.0,461849.0,125108.0,465907.0,156972.0,139083.0,127389.0,237263.0,311691.0,156536.0,155322.0,133368.0,329715.0,256088.0,116835.0,116835.0,823762.0,183836.0,1110239.0,1110239.0,385072.0,599637.0,387285.0,291580.0,291580.0,291580.0,338582.0,884415.0,525622.0,322587.0,223348.0,668858.0,143039.0,627590.0,239797.0,232788.0,256503.0,209425.0,375474.0,558106.0,290991.0,1176648.0,286550.0,149539.0,297435.0,602136.0,152733.0,212363.0,178992.0,179644.0,295428.0,933636.0,349405.0,660749.0,226061.0,868852.0,318539.0,469303.0,538061.0,273643.0,444084.0,347730.0,825808.0,12011.0,7792372.0)

pca<-prcomp(vols, xret=TRUE, scale=TRUE)
pred.vals<-array(pca$x[,1])
pred.vals<-pred.vals + 100/length(pred.vals) - mean(pred.vals)

for(i in 1:104) {
    if(pred.vals[i]<0) { pred.vals[i]<-0 }
}
pred.vals<-100*pred.vals/sum(pred.vals)

print("pred.vals contains scaled volume profile PCA prediction")
